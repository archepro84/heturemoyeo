# βοΈν•­ν•΄ μµμΆ… ν”„λ΅μ νΈ - Backend
![ν—¤μ³λ¨μ—¬](https://user-images.githubusercontent.com/47944165/131612195-a6ef2741-f344-4c67-9e07-84e8d2f0b7df.png)


## π  [Home Page](https://moyeora.org) / [Youtube](https://youtu.be/MpwPiutwqaY)
- μ£Όλ³€ μ‚¬λλ“¤μ„ μ†μ‰½κ² λ§λ‚κ³  μ†ν†µν•κΈ° μ„ν•, μ‹¤μ‹κ°„ μ„μΉκΈ°λ° μ†λ¨μ„ ν”λ«νΌ!

## π© ν”„λ΅μ νΈ μ†κ°
#### μ‹¤μ‹κ°„ μ„μΉ κΈ°λ° μ†λ¨μ„ ν”λ«νΌ!

 - π‘« μ°λ¦¬λ™λ„¤, κ°™μ€ μ·¨λ―Έλ¥Ό κ°€μ§„ μ‚¬λμ„ λ§λ‚κ³  μ‹¶μΌμ‹ κ°€μ”?
 - π—Ί μ‚¬μ†ν• μΌμƒμ—μ„λ¶€ν„° λ‹¤μ–‘ν•κ³  μƒ‰λ‹¤λ¥Έ κ²½ν—κΉμ§€ μ°Ύμ„ μ μλ” κ³³!
 - π®λ‹Ήμ‹ κ³Όμ λ§λ‚¨μ„ κΈ°λ‹¤λ¦¬κ³  μλ” μ΄μ›ƒμ„ λ§λ‚λ³΄μ„Έμ”.


## π—“ ν”„λ΅μ νΈ κΈ°κ°„
2021λ…„ 7μ›” 23μΌ ~ 2021λ…„ 9μ›” 02μΌ


## π‘¥ κ°λ° μΈμ›
- μ΄μ©μ° (Node.js) [ν€μ¥] @ [archepro84](https://github.com/archepro84)
- μ΄ν•΄μ›… (Node.js) @ [HW3542](https://github.com/HW3542)
- μ„κ΄€μ‹ (Node.js) @ [gwansiklim](https://github.com/gwansiklim)
- μ£Όμ¬μΈ (React) @ [joonior99](https://github.com/joonior99)
- ν™©μ¤€μ—° (React) @ [yoojin-kim90](https://github.com/yoojin-kim90)
- κΉ€μ μ§„ (React) @ [demian0721](https://github.com/demian0721)
- μ„μ •ν™” (λ””μμ΄λ„)
- μ •μ§€μ° (λ””μμ΄λ„)


## π›  κΈ°μ μ¤νƒ

Front | Back
---|:---:
React | Node.js
Redux | Express
Axios | MySQL
'' | Redis
Socket.io | Socket.io
μΉ΄μΉ΄μ¤λ§µ API | μΉ΄μΉ΄μ¤λ§µ API


## π“– λΌμ΄λΈλ¬λ¦¬

λΌμ΄λΈλ¬λ¦¬ | μ„¤λ…
---|:---:
<img src='https://img.shields.io/badge/cookie--parser-1.4.5-lightgrey'>  | μΏ ν‚¤ μ €μ¥
<img src='https://img.shields.io/badge/cors-2.8.5-lightgrey'> | κµμ°¨ λ¦¬μ†μ¤ κ³µμ 
<img src='https://img.shields.io/badge/crypto--js-4.1.1-lightgrey'> | λΉ„λ°€λ²νΈ μ•”νΈν™”
<img src='https://img.shields.io/badge/dotenv-10.0.0-lightgrey'>  | ν™κ²½λ³€μ κ΄€λ¦¬
<img src='https://img.shields.io/badge/express-4.17.1-lightgrey'> | μ„λ²„
<img src='https://img.shields.io/badge/express--session-1.17.2-lightgrey'> | μ„Έμ… κ΄€λ¦¬
<img src='https://img.shields.io/badge/joi-17.4.1-lightgrey'>  | μ…λ ¥λ°μ΄ν„° κ²€μ¶
<img src='https://img.shields.io/badge/jsonwebtoken-8.5.1-lightgrey'>  | μ„λ… μ•”νΈν™”
<img src='https://img.shields.io/badge/morgan-1.10.0-lightgrey'> | Http Log κΈ°λ΅
<img src='https://img.shields.io/badge/nunjucks-3.2.3-lightgrey'> | ν…ν”λ¦Ώ μ–Έμ–΄
<img src='https://img.shields.io/badge/chokidar-2.8.5-lightgrey'> | νμΌ κ°μ‹ λΌμ΄λΈλ¬λ¦¬
<img src='https://img.shields.io/badge/redis-3.1.2-lightgrey'>  | μΊμ‹ λ©”λ¨λ¦¬ DB κ΄€λ¦¬
<img src='https://img.shields.io/badge/georedis-3.1.3-lightgrey'>  | μ„μΉ μ •λ³΄ κ΄€λ¦¬
<img src='https://img.shields.io/badge/request-2.88.2-lightgrey'> | μ™Έλ¶€ API μ”μ²­
<img src='https://img.shields.io/badge/mysql-2.18.1-lightgrey'> | MySQL
<img src='https://img.shields.io/badge/sequelize-6.6.5-lightgrey'>  | MySQL ORM
<img src='https://img.shields.io/badge/sequelize--cli-6.2.0-lightgrey'> | MySQL ORM Console
<img src='https://img.shields.io/badge/socket.io-4.2.0-lightgrey'> | Socket ν†µμ‹ 
<img src='https://img.shields.io/badge/jest-27.0.6-lightgrey'>  | ν…μ¤νΈ μ½”λ“
<img src='https://img.shields.io/badge/swagger--ui--express-4.1.6-lightgrey'> | API λ¬Έμ„ν™”
<img src='https://img.shields.io/badge/artillery-1.7.7-lightgrey'> | μ„λ²„ λ¶€ν• ν…μ¤νΈ


<br>

## π“ ν”„λ΅μ νΈ μ•„ν‚¤ν…μ²
![ν—¤μ³λ¨μ—¬ μ•„ν‚¤ν…μ²](https://user-images.githubusercontent.com/49636918/131686936-176aa7b7-e40f-4ee4-a5de-c0ef1000c138.png)

<br>

## π—ƒ DB ERD
![drawSQL-export-2021-09-01_22_37](https://user-images.githubusercontent.com/49636918/131681338-538513a2-1272-479b-92c3-6b95ce49420e.png)

<br>

## π“‹ [API Document](https://docs.google.com/spreadsheets/d/11TuiaIZ62mFtalb1SdkpFQVbLejM8pN0hRjcK1keJn0/edit?usp=sharing)

## π“‚ [Project Board](https://www.notion.so/99-9-b3c6d3acc4cd489d8abda6c0b7f3c714)

## π”¨ [Front-End Git hub](https://github.com/demian0721/heturemoyeo)


## π“ μ½”λ“ λ¦¬λ·° λ° κ°μ„ μ‚¬ν•­


### 1) Socket GeoRedis μ—°μ‚° λ¶€ν• λ¬Έμ  
#### λ°μƒν• λ¬Έμ 
- κΈ°μ΅΄μ—λ” MySQL μ‚¬μ©μμ μ„μΉ μ •λ³΄λ¥Ό GeoMetry Point νƒ€μ…μΌλ΅ μ €μ¥ν•μ€μ§€λ§, μ„λ²„ λ¶€ν• ν…μ¤νΈλ¥Ό μ§„ν–‰ν•λ©΄μ„ μ‹¤μ‹κ°„μΌλ΅ μ£Όλ³€ μ„μΉλ¥Ό κ°€κ³µν•  λ• λ§μ€ λ¶€ν•λ¥Ό λ°μƒν•λ” κ²ƒμ„ ν™•μΈν•μ€μµλ‹λ‹¤. 

#### κ°μ„  λ°©λ²•
- Redisμ GEORADIUSBYMEMBER ν•¨μλ¥Ό μ‚¬μ©ν•  κ²½μ° λ§μ€ λ¶€ν•λ¥Ό λ“¤μ΄μ§€ μ•κ³  μ‚¬μ©μ μ£Όλ³€μ μ •λ³΄λ¥Ό μ΅°νν•  μ μλ‹¤λ” κ²ƒμ„ ν™•μΈν–μµλ‹λ‹¤.
- MySQLμ—μ„ μ‚¬μ©ν•κ³  μλ μ‚¬μ©μμ μ„μΉ μ •λ³΄λ¥Ό Redisμ GeoMetry λ°μ΄ν„°λ΅ λ³€κ²½ν•μ—¬ μ‚¬μ©μμ μ„μΉμ •λ³΄ κ°€κ³µμ†λ„λ¥Ό ν–¥μƒ μ‹ν‚¬ μ μμ—μµλ‹λ‹¤.

![ν—¤μ³λ¨μ—¬ Socket ν†µμ‹  κµ¬μ΅°](https://user-images.githubusercontent.com/49636918/131671829-b3aa9261-512a-48f2-9b16-412ee465d7a3.png)



<br><br>
### 2) Express API λ¶€ν• ν…μ¤νΈ

#### λ°μƒν• λ¬Έμ 
- ν„μ¬ μ„λ²„κ°€ λ²„ν‹Έ μ μλ” λ¶€ν•λ‰μ„ ν™•μΈν•μ—¬, μ μ ν• μ„λ²„μ κµ¬μ„±μ΄ ν•„μ”ν•λ‹¤κ³  μƒκ°ν•μ€μµλ‹λ‹¤.
- λ‹¨μν λ¶€ν• ν…μ¤νΈλ¥Ό μ§„ν–‰ν•  λ• μΌμΌμ΄ μ‚¬μ©μκ°€ λ…λ Ήμ„ λ³΄λ‚΄ ν…μ¤νΈν•λ” κ²ƒμ€ λΉ„ν¨μ¨μ μ΄λΌ μƒκ°ν•μ€μµλ‹λ‹¤.

#### κ°μ„  λ°©λ²•
- Artillery λ¨λ“μ„ μ΄μ©ν•΄ μ‹¤μ‹κ°„μΌλ΅ Express.jsμ λ¶€ν• ν…μ¤νΈλ¥Ό μ§„ν–‰ν•  μ μμ—κ³ , Socket.Ioμ—μ„ μ‹¤μ‹κ°„μΌλ΅ μ‚¬μ©μμ μ„μΉ μ •λ³΄λ¥Ό λ³΄λ‚΄λ” λ¶€ν• ν…μ¤νΈλ„ μ§„ν–‰ ν•  μ μμ—μµλ‹λ‹¤.

![ν—¤μ³λ¨μ—¬ λ¦¬λ“ λ―Έ λ¶€ν• ν…μ¤νΈ κ²°κ³Ό](https://user-images.githubusercontent.com/49636918/131679620-aab58342-ca5b-49ca-9f5d-3f38d6c395d3.png)


### 3) Socket λ¶€ν• ν…μ¤νΈ

#### λ°μƒν• λ¬Έμ 
- ν„μ¬ μ„λ²„κ°€ λ²„ν‹Έ μ μλ” λ¶€ν•λ‰μ„ ν™•μΈν•μ—¬, μ μ ν• μ„λ²„μ κµ¬μ„±μ΄ ν•„μ”ν•λ‹¤κ³  μƒκ°ν•μ€μµλ‹λ‹¤.
- μ‹¤μ‹κ°„μΌλ΅ μ‚¬μ©μμ μ„μΉλ¥Ό μ…λ ¥ λ° μ΅°νν•λ” κΈ°λ¥μ ν•λ„λ¥Ό ν™•μΈν•  μ μμ–΄μ•Ό μ•μ „ν• μ„λ²„ κµ¬ν„μ΄ κ°€λ¥ν•  κ²ƒμΌλ΅ μƒκ°ν•μ€μµλ‹λ‹¤.

#### κ°μ„  λ°©λ²•
- Artillery λ¨λ“μ—μ„λ” Socket.Io-v3μ Headerλ¥Ό μ§€μ›ν•μ§€ μ•μ•„ μ‚¬μ©μ μΈμ¦μ„ λ°›μ„ μ μ—†μ—μµλ‹λ‹¤.
- μ°¨μ„ μ±…μΌλ΅ μμ²΄ μ μ‘ν• λ”λ―Έ μ†μΌ“ ν΄λΌμ΄μ–ΈνΈλ¥Ό μƒμ„±ν•μ—¬ ν…μ¤νΈν•μ€μµλ‹λ‹¤.
- 1,000λ…μ μ†μΌ“μ„ ν…μ¤νΈν–μ„ λ• EC2: 20%, Redis: 9%μ CPU ν• λ‹Ήλ‰μ„ λ³΄μ€μµλ‹λ‹¤.
- 1,000λ…μ μ†μΌ“μ„ ν…μ¤νΈν–μ„ λ• Redisμ λ©”λ¨λ¦¬ ν• λ‹Ήλ‰μ΄ 1%μ—μ„ 1.6%λ΅ μƒμΉν•μ€μµλ‹λ‹¤.

![ν—¤μ³λ¨μ—¬ μ†μΌ“ λ¶€ν• ν…μ¤νΈ](https://user-images.githubusercontent.com/49636918/132089052-e0eaf4a3-c515-4457-9053-92ff207f1dcf.png)

<br><br>
### 4) ν…μ¤νΈ μ½”λ“ κµ¬μ„±

#### λ°μƒν• λ¬Έμ 
- ν€μ›λ“¤μ΄ λ™μ‹μ— μ½”λ“λ¥Ό μμ •ν•κ² λ  κ²½μ°, λ³€κ²½λλ” μ‚¬ν•­μ΄ μΌμΉν•μ§€ μ•μ•„ μ¤λ¥κ°€ λ°μƒν•μ€μµλ‹λ‹¤.
- μ½”λ“λ¥Ό μμ •ν•  λ•λ§λ‹¤ λ¨λ“  APIμ μ‘λ™ μ—¬λ¶€λ¥Ό μΌμΌμ΄ κ²€μ‚¬ν•λ” κ²ƒμ΄ λΉ„ν¨μ¨μ μ΄μ—μµλ‹λ‹¤.

#### κ°μ„  λ°©λ²•  
- Swaggerλ¥Ό μ΄μ©ν•΄ λ¨λ“  APIλ¥Ό λ¬Έμ„ν™”ν•μ€κ³ , ν…μ¤νΈν•  μ μλ„λ΅ κµ¬ν„ν•μ€μµλ‹λ‹¤.
- Joi Schemaλ¶€ν„° λ¨λ“  APIμ— μ΄λ¥΄κΈ°κΉμ§€ Jestλ¥Ό μ΄μ©ν•΄ ν…μ¤νΈ μ½”λ“λ¥Ό μƒμ„±ν•μ€μµλ‹λ‹¤.

<br><br>
### 5) λ¨λ…Έλ¦¬ν‹± μ•„ν‚¤ν…μ² λ²—μ–΄λ‚κΈ°

#### λ°μƒν• λ¬Έμ 
- EC2 λ‹¨μΌ μ„λ²„μ—μ„ Express.js, MySQL, Redisλ¥Ό μ‚¬μ©ν•μ—¬ λ§μ€ λ¶€ν•κ°€ λ°μƒν•μ€μµλ‹λ‹¤.
- λ¶€ν• ν…μ¤νΈλ¥Ό μ§„ν–‰ν•μ€μ„ λ• μ„λ²„κ°€ λ‹¤μ΄λμ–΄ MySQLμ λ°μ΄ν„° μ‚¬λΌμ§€κ±°λ‚, Redisμ Key λ°μ΄ν„°κ°€ μ΄κΈ°ν™”λλ” λ“± λ°μ΄ν„°μ μ•μ •μ„±μ„ λ³΄μ¥ν•  μ μ—†μ—μµλ‹λ‹¤.

#### κ°μ„  λ°©λ²•
- EC2λ¥Ό Express λ‹¨μΌ μ„λ²„λ΅ κµ¬μ„±ν•μ€κ³ , AWS ElastiCacheλ΅ Redis μ„λ²„μ λ°μ΄ν„°λ¥Ό μ΄κ΄€ν•μ€κ³ , AWS RDSλ΅ MySQL 5.7 μ„λ²„μ λ°μ΄ν„°λ¥Ό μ΄κ΄€ν•μ€μµλ‹λ‹¤.
- λ‹¨μΌ μ„λ²„μ—μ„ λ¨λ“  κ²ƒμ„ μ²λ¦¬ν•λ” λ¨λ…Έλ¦¬ν‹± μ•„ν‚¤ν…μ²μ—μ„ λ¨λ“  μ„λ²„λ¥Ό λ¶„λ¦¬ν•μ—¬ κ΄€λ¦¬ν•λ” λ§μ΄ν¬λ΅ μ„λΉ„μ¤ μ•„ν‚¤ν…μ²λ΅ λ³€κ²½ ν•κΈ°μ„ν•΄ λ…Έλ ¥ν•μ€μµλ‹λ‹¤.
- λ¶€ν• ν…μ¤νΈλ¥Ό μ§„ν–‰ν•μ€μ„ λ• κ²¬λ” μ μλ” λ¶€ν•λ‰μ΄ λμ–΄λ‚¬κ³ , μ„λ²„μ μ•μ •μ„±μ„ ν™•λ³΄ν•  μ μμ—μµλ‹λ‹¤.

<br><br>
### 6) μ„λ²„ λ¨λ‹ν„°λ§ κµ¬μ„±

#### λ°μƒν• λ¬Έμ 
- λ¨λ‹ν„°λ§μ„ μ§„ν–‰ν•  λ• μ„λ²„μ— μ ‘μ†λ μƒν™©μ—μ„λ§ μ„λ²„μ μƒνƒλ¥Ό μ΅°νν•  μ μμ—μµλ‹λ‹¤.
- λ¶€ν• ν…μ¤νΈλ¥Ό μ§„ν–‰ν•μ€μ„ λ• μ ‘μ† μ¤λ¥κ°€ λ°μƒν•΄ μ‹¤μ‹κ°„μΌλ΅ μ„λ²„μ CPU λ° λ©”λ¨λ¦¬ μ‚¬μ©λ‰ μ΅°νκ°€ λ¶κ°€λ¥ν•μ€μµλ‹λ‹¤.

#### κ°μ„  λ°©λ²•
 - λ¶„λ¦¬λμ–΄μλ” AWS μ„λ²„μ μƒν™©μ„ Cloudatchλ¥Ό μ΄μ©ν•μ—¬ λ³„λ„μ ν”„λ΅μ νΈλ¥Ό μƒμ„±ν•μ—¬ μ„λ²„ λ¨λ‹ν„°λ§μ„ μ§„ν–‰ν•μ€μµλ‹λ‹¤.
 - CPU λλ” Memory μ‚¬μ©λ‰μ„ μ„μ ―μΌλ΅ μ„¤μ •ν•  μ μμ—κ³ , μ΄μ™Έμ AWS μ„λ²„μ μ†μ„±μ„ μ‹¤μ‹κ°„μΌλ΅ λ¨λ‹ν„°λ§ν•  μ μμ—μµλ‹λ‹¤.
 ![λ¦¬λ“ λ―Έ Cloud Watch](https://user-images.githubusercontent.com/49636918/131685197-4cc40327-9c14-46ca-b8ce-56f57fb7a57e.png)




<br><br>
